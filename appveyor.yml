# branches to build
branches:
  # whitelist
  only:
    - master

# Start builds on tags only (GitHub, BitBucket, GitLab, Gitea)
# skip_non_tags: true

# Build worker image (VM template)
image: Visual Studio 2019

environment:
  matrix:
  - PYTHON: C:\Python38

install:
- set PATH=%PYTHON%;%PYTHON%/Scripts;%PATH%
- python -m venv venv
- venv/Scripts/activate.bat
- ps: ./build_and_install_pyinstaller.ps1

# to run your custom scripts instead of automatic MSBuild
build_script:
- python -m PyInstaller --onefile main.py
- success

artifacts:
  # pushing a single file
  - path: main.py
    name: python_script

  - path: dist/main.exe
    name: windows_executable

deploy:
  description: 'Initial Version'
  provider: GitHub
  auth_token:
    secure: l6RQlR9p5XLRsTH5GtTs4HMR3b819qt5wDzgQUN2zHjbgVdEMkS83Kojsvwp7Qqt
  artifact: python_script, windows_executable
  draft: false

